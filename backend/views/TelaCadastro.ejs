<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
</head>

<body>
    <center>
        <img src="https://ufrn.br/resources/img/logo-ufrn-color-og.png">
        <h1>TELA DE CADASTRO DE QUESTÕES</h1>

        <form id="formulario" style="width: 400px">

            <div class="mb-3">
                <label for="enunciado" class="form-label">Enunciado</label>
                <input type="text" class="form-control" id="enunciado">
            </div>

            <div class="mb-3">
                <span>
                    Alternativas
                </span>
                <div>
                    <label for="A" class="form-label">A</label>
                    <input type="text" class="form-control" id="A">
                </div>
                <div>
                    <label for="B" class="form-label">B</label>
                    <input type="text" class="form-control" id="B">
                </div>
                <div>
                    <label for="C" class="form-label">C</label>
                    <input type="text" class="form-control" id="C">
                </div>
            </div>

            <div class="mb-3">
                <label for="respostas" class="form-label">Resposta</label>
                <select name="Alternativas" id="resposta">
                    <option value="0">A</option>
                    <option value="1">B</option>
                    <option value="2">C</option>
                </select>
            </div>

            <div class="mb-3">
                <label for="dificuldade" class="form-label">Dificuldade</label>
                <input type="text" class="form-control" id="dificuldade">
            </div>

            <div class="mb-3">
                <label for="categoria" class="form-label">Categoria</label>
                <input type="text" class="form-control" id="categoria">
            </div>
        </form>

        <button class="btn btn-primary" onclick="cadastrar()">Cadastrar</button></br></br>

        <div id="teste"></div><br>


        <button class="btn btn-light"> <a style="text-decoration: none" href="/"> Deslogar </a> </button><br><br>

    </center>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        async function apagar(id) {

        }
        async function carregar() {
            const resposta = await axios.get('http://localhost:3000/question');
            const data = resposta.data.questions;
            var q;
            for (let i = 0; i < data.length; i++) {
                q = `<div class='card' style='width: 18rem;'>\
                            <div class='card-body'>\
                               <h5 class='card-title'>Questão  ${i} </h5>\
                               <p class='card-text'>id:  ${data[i].id} </p><br/>\
                               <p class='card-text'>Enunciado:  ${data[i].enunciado} </p><br/>\
                               <p class='card-text'>A:  ${data[i].alternativas[0]} </p><br/>\
                               <p class='card-text'>B:  ${data[i].alternativas[1]} </p><br/>\
                               <p class='card-text'>C:  ${data[i].alternativas[2]} </p><br/>\
                               <p class='card-text'>Resposta:  ${data[i].resposta} </p><br/>\
                               <p class='card-text'>Dificuldade:  ${data[i].dificuldade} </p><br/>\
                               <p class='card-text'>Categoria:  ${data[i].categoria} </p><br/>\
                               <button class='btn btn-danger' onclick='apagar(${data[i].id})'>APAGAR</button>\
                           </div>\
                        </div></br>`;

                document.getElementById("teste").innerHTML += q;
            }
        }
        carregar();
        function cadastrar() {
            var index = 1;
            var enun = document.getElementById("enunciado").value;
            var altA = document.getElementById("A").value;
            var altB = document.getElementById("B").value;
            var altC = document.getElementById("C").value;
            var res = document.getElementById("resposta").value;
            var difi = document.getElementById("dificuldade").value;
            var cat = document.getElementById("categoria").value;
            var q;
            const token = window.localStorage.getItem('token');

            axios.post('http://localhost:3000/question', {
                enunciado: enun,
                alternativas: [altA, altB, altC],
                resposta: res,
                dificuldade: difi,
                categoria: cat,
            },{headers: {'Authorization': `bearer ${token}`}}).then((value) => {
                q = `<div class='card' style='width: 18rem;'>\
                            <div class='card-body'>\
                               <h5 class='card-title'>Questão  ${index} </h5>\
                               <p class='card-text'>id:  ${index} </p><br/>\
                               <p class='card-text'>Enunciado:  ${enun} </p><br/>\
                               <p class='card-text'>A:  ${altA} </p><br/>\
                               <p class='card-text'>B:  ${altB} </p><br/>\
                               <p class='card-text'>C:  ${altC} </p><br/>\
                               <p class='card-text'>Resposta:  ${res} </p><br/>\
                               <p class='card-text'>Dificuldade:  ${difi} </p><br/>\
                               <p class='card-text'>Categoria:  ${cat} </p><br/>\
                               <button class='btn btn-danger' onclick='apagar(${value.id})'>APAGAR</button>\
                           </div>\
                        </div></br>`;
                document.getElementById("teste").innerHTML += q;
                index++;
            });
        }
    </script>
</body>

</html>